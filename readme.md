# Программа для решения заявок от пользователей сайта Газпром Газораспределение Нижний Новгород

Программа для получения заявок и решения их через БД и другие средства. Позволяет получать письма с почтового сервера, искать клиентов по email и проверять документы клиентов.

## Структура проекта

oblgaz-email-fetcher/
├── main.py # Основной файл запуска приложения
├── config.py # Конфигурационные параметры
├── proxy_manager.py # Менеджер прокси-соединений
├── mail_client.py # Клиент для работы с почтой
├── database_client.py # Клиент для работы с БД SQL Server
├── requirements.txt # Зависимости Python
├── run.sh # Скрипт запуска для Linux
├── README.md # Этот файл
├── ui/ # Модули пользовательского интерфейса
│ ├── init.py
│ ├── main_window.py # Главное окно приложения
│ └── db_work_window.py # Окно работы с базой данных
└── utils/ # Вспомогательные модули
├── init.py
├── logger.py # Система логирования
└── helpers.py # Вспомогательные функции

## Описание файлов

### Основные файлы

- **main.py** - Точка входа приложения. Инициализирует графический интерфейс и запускает приложение.
- **config.py** - Содержит все конфигурационные параметры:
  - Настройки почтового сервера (сервер, порты, логин/пароль)
  - Параметры прокси
  - Настройки SQL Server
  - Параметры целевого отправителя

### Модули работы с данными

- **proxy_manager.py** - Настраивает прокси-соединения для работы через корпоративную сеть
- **mail_client.py** - Обеспечивает подключение к IMAP/SMTP серверам, получение и обработку писем
- **database_client.py** - Осуществляет подключение к SQL Server, выполнение запросов к БД

### Модули пользовательского интерфейса

- **ui/main_window.py** - Главное окно приложения с функциями:
  - Тестирование подключений
  - Получение писем с почтового сервера
  - Открытие окна работы с БД
  - Просмотр системной информации и логов
- **ui/db_work_window.py** - Окно для работы с базой данных:
  - Поиск клиентов по email
  - Проверка документов клиента по ID
  - Копирование ID клиентов и документов

### Вспомогательные модули

- **utils/logger.py** - Система логирования с цветовым кодированием и выводом в интерфейс
- **utils/helpers.py** - Вспомогательные функции (валидация email, обработка дат и т.д.)

## Установка и запуск

### Требования

- Python 3.7+
- Tkinter (обычно входит в состав Python)
- Доступ к корпоративной сети через прокси

### Установка зависимостей

```bash
pip install -r requirements.txt

